@using Microsoft.AspNetCore.Components.Forms
@using Boozor.Shared
@inject AppState _appState

@typeparam TEntity where TEntity : IEntity, new()

<View Model=Model TEntity=TEntity Title=@Title>
    @Fields
</View>

<DataTable TModel=TEntity @bind-Items=Entities OnSelectItem="OnSelectItem" Multiselect=false Delete=true>
    <ChildContent>
        @Columns
    </ChildContent>

    @* <Toolbar>
    <ColumnButton Text="Custom" Color="danger" TModel=Person OnClick="CustomSelect" />
    <ColumnButton Text="Custom2" TModel=Person OnClick="CustomSelect" />
    </Toolbar> *@
</DataTable>


@code {

    [Parameter, EditorRequired]
    public RenderFragment Fields { get; set; }

    [Parameter, EditorRequired]
    public RenderFragment Columns { get; set; }

    [Parameter, EditorRequired]
    public TEntity Model { get; set; } = new();

    [Parameter]
    public string Title { get; set; }//TODO: View.GetTitle

    public List<TEntity> Entities { get; set; } = new();

    public Task OnDelete()
    {
        return Task.Delay(1000);
    }

    private void OnSelectItem(TEntity entity)
    {
        Model = entity;
    }

    private void CustomSelect(TEntity entity)
    {
        Model = entity;
    }
}